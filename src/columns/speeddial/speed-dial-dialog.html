<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input-decorator.html">

<polymer-element name="speed-dial-dialog" attributes="config">
    <template>
        <tabbie-dialog style="width:600px;">
            <style>
                paper-button.green {
                    color:#4CAF50;
                }

                paper-button.red {
                    color:#F44336;
                }

                paper-button.blue {
                    color:#2196F3;
                }

                paper-input {
                    width: 80%;
                }
            </style>


            <template repeat="{{website, index in config.websites}}">
                <div>
                    <paper-input label="Name" required value="{{website.name}}"></paper-input>
                </div>

                <div>
                    <paper-input label="Icon URL" required value="{{website.icon.url}}"></paper-input>
                </div>

                <div>
                    <paper-input label="URL" required value="{{website.url}}"></paper-input>
                </div>

                <paper-button on-click="{{removeWebsite}}" data-index="{{index}}" class="red">
                    Remove
                </paper-button>

                <template if="{{ index > 0 }}">
                    <paper-button on-click="{{moveUp}}" data-index="{{index}}" class="blue">
                        Move entry up
                    </paper-button>
                </template>

                <template if="{{ index < config.websites.length - 1 }}">
                    <paper-button on-click="{{moveDown}}" data-index="{{index}}" class="blue">
                        Move entry down
                    </paper-button>
                </template>

                <br/>
                <hr/>

            </template>

            <div>
                <paper-button on-click="{{addWebsite}}" class="green">
                    Add new website
                </paper-button>
            </div>

        </tabbie-dialog>
    </template>
    <script>

        function moveArrayElem(array, from, to) {
            array.splice(to, 0, array.splice(from, 1)[0]);
        }

        Polymer({
              removeWebsite: function(ev, detail, elem) {
                  var index = elem.getAttribute("data-index");
                  this.config.websites.splice(index, 1);
              },


              addWebsite: function() {
                  this.config.websites.push({
                    name: '',
                    icon: {
                        url: ''
                    },
                    url: ''
                  });
              },


              moveDown: function(ev, detail, elem) {
                  var index = elem.getAttribute("data-index");
                  var websites = this.config.websites;
                  moveArrayElem(websites, index, Math.min(index + 1, websites.length - 1));
              },


              moveUp: function(ev, detail, elem) {
                  var index = elem.getAttribute("data-index");
                  moveArrayElem(this.config.websites, index, Math.max(index - 1, 0));
              }
        })
    </script>
</polymer-element>
